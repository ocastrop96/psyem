$(".datatableProfesionales").DataTable({ajax:"public/views/util/datatable-Profesionales.php",deferRender:!0,retrieve:!0,processing:!0,paging:!0,lengthChange:!0,searching:!0,ordering:!0,order:[[4,"asc"]],info:!0,autoWidth:!1,language:{url:"public/views/resources/js/dataTables.spanish.lang"}}),$("#rgpDni").attr("minlength","8"),$("#rgpDni").attr("maxlength","12"),$("#edtpDni").attr("minlength","8"),$("#edtpDni").attr("maxlength","12"),$("#rgpDni").keyup(function(){this.value=(this.value+"").replace(/[^0-9]/g,"")}),$("#rgpCpsp").keyup(function(){this.value=(this.value+"").replace(/[^0-9]/g,"")}),$("#edtpDni").keyup(function(){this.value=(this.value+"").replace(/[^0-9]/g,"")}),$("#edtpCpsp").keyup(function(){this.value=(this.value+"").replace(/[^0-9]/g,"")}),$("#rgpNombres").keyup(function(){this.value=(this.value+"").replace(/[^a-zA-ZñÑáéíóúüÁÉÍÓÚÜ ]/g,"")}),$("#rgpApellidos").keyup(function(){this.value=(this.value+"").replace(/[^a-zA-ZñÑáéíóúüÁÉÍÓÚÜ ]/g,"")}),$("#edtpNombres").keyup(function(){this.value=(this.value+"").replace(/[^a-zA-ZñÑáéíóúüÁÉÍÓÚÜ ]/g,"")}),$("#edtpApellidos").keyup(function(){this.value=(this.value+"").replace(/[^a-zA-ZñÑáéíóúüÁÉÍÓÚÜ ]/g,"")}),$("#rgpNombres").keyup(function(){var e=$(this).val().toUpperCase();$("#rgpNombres").val(e)}),$("#rgpApellidos").keyup(function(){var e=$(this).val().toUpperCase();$("#rgpApellidos").val(e)}),$("#edtpNombres").keyup(function(){var e=$(this).val().toUpperCase();$("#edtpNombres").val(e)}),$("#edtpApellidos").keyup(function(){var e=$(this).val().toUpperCase();$("#edtpApellidos").val(e)}),$.validator.addMethod("valueNotEquals",function(e,o,i){return i!==e},"Value must not equal arg."),$("#btnRegProf").on("click",function(){$("#formRegProf").validate({rules:{rgpCondicion:{valueNotEquals:"0",required:!0},rgpDni:{required:!0,maxlength:12,minlength:8},rgpCpsp:{required:!0},rgpNombres:{required:!0},rgpApellidos:{required:!0}},messages:{rgpCondicion:{valueNotEquals:"Seleccione Condición",required:"Seleccione condición de profesional"},rgpDni:{required:"DNI Requerido",maxlength:"Ingrese máximo 12 dígitos",minlength:"Ingrese mínimo 8 dígitos"},rgpCpsp:{required:"CPsP Requerido"},rgpNombres:{required:"Nombres requerido"},rgpApellidos:{required:"Apellidos requerido"}},errorElement:"span",errorPlacement:function(e,o){e.addClass("invalid-feedback"),o.closest(".form-group").append(e)},highlight:function(e,o,i){$(e).addClass("is-invalid")},unhighlight:function(e,o,i){$(e).removeClass("is-invalid")}})}),$("#btnEdtProf").on("click",function(){$("#formEdtProf").validate({rules:{edtpCondicion:{valueNotEquals:"0",required:!0},edtpDni:{required:!0,maxlength:12,minlength:8},edtpCpsp:{required:!0},edtpNombres:{required:!0},edtpApellidos:{required:!0}},messages:{edtpCondicion:{valueNotEquals:"Seleccione Condición",required:"Seleccione condición de profesional"},edtpDni:{required:"DNI Requerido",maxlength:"Ingrese máximo 12 dígitos",minlength:"Ingrese mínimo 8 dígitos"},edtpCpsp:{required:"CPsP Requerido"},edtpNombres:{required:"Nombres requerido"},edtpApellidos:{required:"Apellidos requerido"}},errorElement:"span",errorPlacement:function(e,o){e.addClass("invalid-feedback"),o.closest(".form-group").append(e)},highlight:function(e,o,i){$(e).addClass("is-invalid")},unhighlight:function(e,o,i){$(e).removeClass("is-invalid")}})}),$("#rgpDni").change(function(){const e=Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:1500});var o=$(this).val(),i=new FormData;i.append("validarDni",o),$.ajax({url:"public/views/src/ajaxProfesionales.php",method:"POST",data:i,cache:!1,contentType:!1,processData:!1,dataType:"json",success:function(o){o?(e.fire({icon:"warning",title:"El DNI Ingresado ya se encuentra registrado"}),$("#rgpDni").val(""),$("#rgpDni").focus(),$("#rgpCpsp").val(""),$("#rgpNombres").val(""),$("#rgpApellidos").val("")):($("#rgpNombres").val(""),$("#rgpApellidos").val(""),$("#btnDNIP").on("click",function(){var e=$("#rgpDni").val();(e.length=8)&&$.ajax({type:"GET",url:"https://dniruc.apisperu.com/api/v1/dni/"+e+"?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6Im9jYXN0cm9wLnRpQGdtYWlsLmNvbSJ9.XtrYx8wlARN2XZwOZo6FeLuYDFT6Ljovf7_X943QC_E",contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){$("#rgpNombres").val(e.nombres),$("#rgpApellidos").val(e.apellidoPaterno+" "+e.apellidoMaterno),$("#rgpCondicion").focus(),$("#rgpNombres").prop("readonly",!0),$("#rgpApellidos").prop("readonly",!0)},failure:function(e){toastr.info("No se pudo conectar los datos","DNI")},error:function(e){$("#rgpNombres").prop("readonly",!1),$("#rgpApellidos").prop("readonly",!1),$("#rgpDni").focus(),$("#formRegProf").trigger("reset")}})}))}})}),$("#edtpDni").change(function(){const e=Swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:1500});var o=$(this).val(),i=new FormData;i.append("validarDni",o),$.ajax({url:"public/views/src/ajaxProfesionales.php",method:"POST",data:i,cache:!1,contentType:!1,processData:!1,dataType:"json",success:function(o){o?(e.fire({icon:"warning",title:"El DNI Ingresado ya se encuentra registrado"}),$("#edtpDni").val(""),$("#edtpDni").focus()):($("#edtpNombres").val(""),$("#edtpApellidos").val(""),$("#btnDNIEdtP").on("click",function(){var e=$("#edtpDni").val();(e.length=8)&&$.ajax({type:"GET",url:"https://dniruc.apisperu.com/api/v1/dni/"+e+"?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJlbWFpbCI6Im9jYXN0cm9wLnRpQGdtYWlsLmNvbSJ9.XtrYx8wlARN2XZwOZo6FeLuYDFT6Ljovf7_X943QC_E",contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){$("#edtpNombres").val(e.nombres),$("#edtpApellidos").val(e.apellidoPaterno+" "+e.apellidoMaterno),$("#edtpCondicion").focus(),$("#edtpNombres").prop("readonly",!0),$("#edtpApellidos").prop("readonly",!0)},failure:function(e){toastr.info("No se pudo conectar los datos","DNI")},error:function(e){$("#edtpNombres").prop("readonly",!1),$("#edtpApellidos").prop("readonly",!1),$("#edtpDni").focus(),$("#formEdtProf").trigger("reset")}})}))}})}),$(".datatableProfesionales tbody").on("click",".btnEditarProfesional",function(){var e=$(this).attr("idProfesional"),o=new FormData;o.append("idProfesional",e),$.ajax({url:"public/views/src/ajaxProfesionales.php",method:"POST",data:o,cache:!1,contentType:!1,processData:!1,dataType:"json",success:function(e){$("#idProfesional").val(e.idProfesional),$("#edtpDni").val(e.dniProfesional),$("#edtpCpsp").val(e.cpspProfesional),$("#edtpNombres").val(e.nombresProfesional),$("#edtpApellidos").val(e.apellidosProfesional),$("#edtpCondicion").val(e.idCondicion),$("#edtpCondicion").html(e.detaCondicion)}})}),$(".datatableProfesionales tbody").on("click",".btnAltaBajaProf",function(){var e=$(this).attr("idProfesional"),o=$(this).attr("idEstado"),i=new FormData;i.append("idProfesional2",e),i.append("idEstado",o),$.ajax({url:"public/views/src/ajaxProfesionales.php",method:"POST",data:i,cache:!1,contentType:!1,processData:!1,success:function(e){1==o?toastr.success("¡El profesional ha sido dado de alta!"):toastr.error("¡El profesional ha sido dado de baja!")}}),2==o?($(this).removeClass("btn-success"),$(this).addClass("btn-danger"),$(this).html('<i class="fas fa-arrow-down"></i>&nbsp; BAJA'),$(this).attr("idEstado",1)):($(this).addClass("btn-success"),$(this).removeClass("btn-danger"),$(this).html('<i class="fas fa-arrow-up"></i>&nbsp; ALTA'),$(this).attr("idEstado",2))}),$(".datatableProfesionales tbody").on("click",".btnEliminarProfesional",function(){var e=$(this).attr("idProfesional");Swal.fire({title:"¿Está seguro de eliminar al profesional?",text:"¡Si no lo está, puede cancelar la acción!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#343a40",cancelButtonColor:"#d33",confirmButtonText:"¡Sí, eliminar Profesional!",cancelButtonText:"¡No, cancelar"}).then(function(o){o.value&&(window.location="index.php?ruta=profesionales&idProfesional="+e)})});