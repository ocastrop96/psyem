function mostrarPaciente(e,a){$.ajax({url:"public/views/src/ajaxCuentas.php",method:"POST",dataType:"html",data:{dato:e,filtro:a}}).done(function(e){$("#dataCuenta").html(e)}).fail(function(){console.log("error")})}function ValidarCuentaExistente(e){var a=e,t=new FormData;t.append("cuentaAtencion",a),$.ajax({url:"public/views/src/ajaxAtenciones.php",method:"POST",data:t,cache:!1,contentType:!1,processData:!1,dataType:"json",success:function(e){e?(Swal.fire({icon:"error",title:"¡El N° de Cuenta de Atención Seleccionado ya está registrado, en la <br>Ficha N° "+e.correlativo_Atencion+"!",showConfirmButton:!1,timer:1700}),$("#dataCuenta").html(""),$("#searchCuenta").val(""),$("#searchCuenta").focus()):seleccionarAtencion(a)}})}function seleccionarAtencion(e){var a=e,t=new FormData;t.append("idCuenta",a);var o="";$.ajax({url:"public/views/src/ajaxCuentas.php",method:"POST",data:t,cache:!1,contentType:!1,processData:!1,dataType:"json",success:function(e){$("#idEpisodio").val(e.IdAtencion),$("#rgaNCuenta").val(e.IdCuentaAtencion),$("#rgaNHC").val(e.NroHistoriaClinica),$("#rgaFNac").val(e.FechaNacimiento),$("#rgaFIngServicio").val(e.FechaIngreso),$("#rgaTdoc").val(e.DescripcionAbrev),$("#rgaNDoc").val(e.NroDocumento),$("#rgaAPaterno").val(e.ApellidoPaterno),$("#rgaAMaterno").val(e.ApellidoMaterno),o=null==e.SegundoNombre?"":e.SegundoNombre,$("#rgaNombres").val(e.PrimerNombre+" "+o),$("#rgaEdad").val(e.EDAD_PAC),$("#rgaFinancia").val(e.FUENTE_PAC),$("#rgaDistrito").val(e.DISTRITO_PAC),$("#rgaServicio").val(e.Nombre+" - "+e.TIPO_SERVICIO),$("#setSex").val(e.IdTipoSexo),$("#setSex").html(e.SEXO_PAC),1==e.IdTipoServicio?($("#setEstado").val(2),$("#setEstado").html("ALTA")):1==e.IdTipoServicio||1==e.IdCondicionAlta||2==e.IdCondicionAlta||3==e.IdCondicionAlta?($("#setEstado").val(2),$("#setEstado").html("ALTA")):4==e.IdCondicionAlta?($("#setEstado").val(3),$("#setEstado").html("FALLECIDO")):($("#setEstado").val(1),$("#setEstado").html("HOSPITALIZADO")),$("#modal-busqueda-cuenta").modal("hide"),$("#searchCuenta").val(""),$("#dataCuenta").html("")}})}function mostrarPaciente2(e,a,t){$.ajax({url:"public/views/src/ajaxCuentas.php",method:"POST",dataType:"html",data:{dato2:e,filtro2:a,cActual:t}}).done(function(e){$("#dataCuenta2").html(e)}).fail(function(){console.log("error")})}function ValidarCuentaExistente2(e,a){var t=e,o=a,n=new FormData;t==o?seleccionarAtencion2(e):o!=t&&""!=o&&(n.append("cuentaAtencion",t),$.ajax({url:"public/views/src/ajaxAtenciones.php",method:"POST",data:n,cache:!1,contentType:!1,processData:!1,dataType:"json",success:function(a){a?(Swal.fire({icon:"error",title:"¡El N° de Cuenta de Atención Seleccionado ya está registrado, en la <br>Ficha N° "+a.correlativo_Atencion+"!",showConfirmButton:!1,timer:1700}),$("#dataCuenta2").html(""),$("#searchCuenta2").val(""),$("#searchCuenta2").focus()):seleccionarAtencion2(e)}}))}function seleccionarAtencion2(e){var a=e,t=new FormData;t.append("idCuenta",a);var o="";$.ajax({url:"public/views/src/ajaxCuentas.php",method:"POST",data:t,cache:!1,contentType:!1,processData:!1,dataType:"json",success:function(e){$("#idEpisodioEdt").val(e.IdAtencion),$("#edtaNCuenta").val(e.IdCuentaAtencion),$("#edtaNHC").val(e.NroHistoriaClinica),$("#edtaFNac").val(e.FechaNacimiento),$("#edtaFIngServicio").val(e.FechaIngreso),$("#edtaTdoc").val(e.DescripcionAbrev),$("#edtaNDoc").val(e.NroDocumento),$("#edtaAPaterno").val(e.ApellidoPaterno),$("#edtaAMaterno").val(e.ApellidoMaterno),o=null==e.SegundoNombre?"":e.SegundoNombre,$("#edtaNombres").val(e.PrimerNombre+" "+o),$("#edtaEdad").val(e.EDAD_PAC),$("#edtaFinancia").val(e.FUENTE_PAC),$("#edtaDistrito").val(e.DISTRITO_PAC),$("#edtaServicio").val(e.Nombre+" - "+e.TIPO_SERVICIO),$("#setSex2").val(e.IdTipoSexo),$("#setSex2").html(e.SEXO_PAC),1==e.IdCondicionAlta||2==e.IdCondicionAlta||3==e.IdCondicionAlta?($("#setEstado2").val(2),$("#setEstado2").html("ALTA")):4==e.IdCondicionAlta?($("#setEstado2").val(3),$("#setEstado2").html("FALLECIDO")):($("#setEstado2").val(1),$("#setEstado2").html("HOSPITALIZADO")),$("#modal-busqueda-cuenta-edt").modal("hide"),$("#searchCuenta2").val(""),$("#dataCuenta2").html("")}})}$("#deshacer-filtro-Ate").on("click",function(){window.location="atenciones"}),$("#rango-atencion").daterangepicker({ranges:{Hoy:[moment(),moment()],Ayer:[moment().subtract(1,"days"),moment().subtract(1,"days")],"Últimos 7 días":[moment().subtract(6,"days"),moment()],"Últimos 30 días":[moment().subtract(29,"days"),moment()],"Este mes":[moment().startOf("month"),moment().endOf("month")],"Último mes":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")]},startDate:moment(),endDate:moment(),maxSpan:{days:30},opens:"left",locale:{format:"DD/MM/YYYY",separator:" - ",applyLabel:"APLICAR",cancelLabel:"CANCELAR",fromLabel:"Desde",toLabel:"Hasta",customRangeLabel:"Personalizar",weekLabel:"W",daysOfWeek:["Do","Lu","Ma","Mie","Ju","Vi","Sa"],monthNames:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Setiembre","Octubre","Noviembre","Diciembre"],firstDay:1}},function(e,a){$("#daterange-btn span").html(e.format("MMMM D, YYYY")+"-"+a.format("MMMM D, YYYY"));var t=e.format("YYYY-MM-DD"),o=a.format("YYYY-MM-DD"),n=$("#daterange-btn span").html();let r;localStorage.setItem("capRangoAte",n),window.location="index.php?ruta=atenciones&fechaInicialAte="+t+"&fechaFinalAte="+o,Swal.fire({title:"Se está cargando la información",html:"Espere por favor...",timer:7e3,timerProgressBar:!0,onBeforeOpen:()=>{Swal.showLoading(),r=setInterval(()=>{const e=Swal.getContent();if(e){const a=e.querySelector("b");a&&(a.textContent=Swal.getTimerLeft())}},100)},onClose:()=>{clearInterval(r)}}).then(e=>{e.dismiss,Swal.DismissReason.timer})}),$(".daterangepicker.opensleft .drp-buttons .cancelBtn").on("click",function(){let e;localStorage.removeItem("capRangoAte"),localStorage.clear(),window.location="atenciones",Swal.fire({title:"Se está cargando la información",html:"Espere por favor...",timer:7e3,timerProgressBar:!0,onBeforeOpen:()=>{Swal.showLoading(),e=setInterval(()=>{const e=Swal.getContent();if(e){const a=e.querySelector("b");a&&(a.textContent=Swal.getTimerLeft())}},100)},onClose:()=>{clearInterval(e)}}).then(e=>{e.dismiss===Swal.DismissReason.timer&&console.log("I was closed by the timer")})}),$(".daterangepicker.opensleft .ranges li").on("click",function(){if("Hoy"==$(this).attr("data-range-key")){var e=new Date,a=e.getDate(),t=e.getMonth()+1,o=e.getFullYear();a=("0"+a).slice(-2);var n=o+"-"+(t=("0"+t).slice(-2))+"-"+a,r=o+"-"+t+"-"+a;let i;localStorage.setItem("capRangoAte","Hoy"),window.location="index.php?ruta=atenciones&fechaInicialAte="+n+"&fechaFinalAte="+r,Swal.fire({title:"Se está cargando la información",html:"Espere por favor...",timer:7e3,timerProgressBar:!0,onBeforeOpen:()=>{Swal.showLoading(),i=setInterval(()=>{const e=Swal.getContent();if(e){const a=e.querySelector("b");a&&(a.textContent=Swal.getTimerLeft())}},100)},onClose:()=>{clearInterval(i)}}).then(e=>{e.dismiss===Swal.DismissReason.timer&&console.log("I was closed by the timer")})}}),$(".datatableAtenciones").DataTable({deferRender:!0,retrieve:!0,processing:!0,paging:!0,lengthChange:!0,searching:!0,ordering:!0,order:[[1,"desc"]],info:!0,autoWidth:!1,language:{url:"public/views/resources/js/dataTables.spanish.lang"}}),$.validator.addMethod("valueNotEquals",function(e,a,t){return t!==e},"Value must not equal arg."),$("#btnRegAte").on("click",function(){$("#formRegAte").validate({rules:{rgaNCuenta:{required:!0},rgaNHC:{required:!0},rgaFNac:{required:!0},rgaTdoc:{required:!0},rgaNDoc:{required:!1},rgaAPaterno:{required:!0},rgaNombres:{required:!0},rgaEdad:{required:!0},rgaSexo:{valueNotEquals:"0",required:!0},rgaFinancia:{required:!0},rgaDistrito:{required:!0},rgaEstadoPac:{valueNotEquals:"0",required:!0},rgaFIngServicio:{required:!0},rgaServicio:{required:!0}},messages:{rgaNCuenta:{required:"Dato requerido"},rgaNHC:{required:"Dato requerido"},rgaFNac:{required:"Dato requerido"},rgaTdoc:{required:"Dato requerido"},rgaNDoc:{required:"Dato requerido"},rgaAPaterno:{required:"Dato requerido"},rgaNombres:{required:"Dato requerido"},rgaEdad:{required:"Dato requerido"},rgaSexo:{valueNotEquals:"Seleccione sexo",required:"Seleccione sexo"},rgaFinancia:{required:"Dato requerido"},rgaDistrito:{required:"Dato requerido"},rgaEstadoPac:{valueNotEquals:"Seleccione Estado de Paciente",required:"Seleccine Estado de Paciente"},rgaFIngServicio:{required:"Dato requerido"},rgaServicio:{required:"Dato requerido"}},errorElement:"span",errorPlacement:function(e,a){e.addClass("invalid-feedback"),a.closest(".form-group").append(e)},highlight:function(e,a,t){$(e).addClass("is-invalid")},unhighlight:function(e,a,t){$(e).removeClass("is-invalid")}})}),$("#btnEdtAte").on("click",function(){$("#formEdtAte").validate({rules:{edtaNCuenta:{required:!0},edtaNHC:{required:!0},edtaFNac:{required:!0},edtaTdoc:{required:!0},edtaNDoc:{required:!1},edtaAPaterno:{required:!0},edtaNombres:{required:!0},edtaEdad:{required:!0},edtaSexo:{valueNotEquals:"0",required:!0},edtaFinancia:{required:!0},edtaDistrito:{required:!0},edtaEstadoPac:{valueNotEquals:"0",required:!0},edtaFIngServicio:{required:!0},edtaServicio:{required:!0}},messages:{edtaNCuenta:{required:"Dato requerido"},edtaNHC:{required:"Dato requerido"},edtaFNac:{required:"Dato requerido"},edtaTdoc:{required:"Dato requerido"},edtaNDoc:{required:"Dato requerido"},edtaAPaterno:{required:"Dato requerido"},edtaNombres:{required:"Dato requerido"},edtaEdad:{required:"Dato requerido"},edtaSexo:{valueNotEquals:"Seleccione sexo",required:"Seleccione sexo"},edtaFinancia:{required:"Dato requerido"},edtaDistrito:{required:"Dato requerido"},edtaEstadoPac:{valueNotEquals:"Seleccione Estado de Paciente",required:"Seleccine Estado de Paciente"},edtaFIngServicio:{required:"Dato requerido"},edtaServicio:{required:"Dato requerido"}},errorElement:"span",errorPlacement:function(e,a){e.addClass("invalid-feedback"),a.closest(".form-group").append(e)},highlight:function(e,a,t){$(e).addClass("is-invalid")},unhighlight:function(e,a,t){$(e).removeClass("is-invalid")}})}),$("#searchCuenta").keyup(function(){this.value=(this.value+"").replace(/[^0-9]/g,"")}),$("#searchCuenta2").keyup(function(){this.value=(this.value+"").replace(/[^0-9]/g,"")}),$("#btnCuentaCarg1").click(function(){var e=$("#searchCuenta").val(),a=$("#fCuenta").val();""!=e&&mostrarPaciente(e,a)}),$("#btnCuentaCarg2").click(function(){var e=$("#searchCuenta2").val(),a=$("#fCuenta2").val(),t=$("#idCuentaAct").val();""!=e&&mostrarPaciente2(e,a,t)}),$(".datatableAtenciones tbody").on("click",".btnEditarAtencion",function(){var e=$(this).attr("idAtencion"),a=new FormData;a.append("idAtencion",e),$.ajax({url:"public/views/src/ajaxAtenciones.php",method:"POST",data:a,cache:!1,contentType:!1,processData:!1,dataType:"json",success:function(e){$("#idCuentaAct").val(e.cuentaAtencion),$("#idEpisodioEdtAct").val(e.idEpisodio),$("#edtaCorrelativo").val(e.correlativo_Atencion),$("#edtaNCuenta").val(e.cuentaAtencion),$("#idAtencion").val(e.idAtencion),$("#idEpisodioEdt").val(e.idEpisodio),$("#edtaNHC").val(e.historiaAtencion),$("#edtaFNac").val(e.fechaPacNacimiento),$("#edtaTdoc").val(e.tipdocAtencion),$("#edtaNDoc").val(e.nrodocAtencion),$("#edtaAPaterno").val(e.apPaternoAtencion),$("#edtaAMaterno").val(e.apMaternoAtencion),$("#edtaNombres").val(e.nombAtencion),$("#edtaEdad").val(e.edadAtencion),$("#edtaFinancia").val(e.financiaAtencion),$("#edtaDistrito").val(e.distritoAtencion),$("#edtaCama").val(e.camaAtencion),$("#edtaFIngServicio").val(e.fIngresoAtencion),$("#edtaServicio").val(e.servAtencion),$("#setSex2").val(e.tipSexoAtencion),$("#setSex2").html(e.detaTipSexo),$("#setEstado2").val(e.idEstadoPacAtencion),$("#setEstado2").html(e.detaEstadoPacAtencion)}})}),$(".datatableAtenciones tbody").on("click",".btnAnularAtencion",function(){var e=$(this).attr("idAtencion"),a=$(this).attr("idCuenta"),t=$(this).attr("idEpisodio"),o=$("#idAtencionUsuario").val();Swal.fire({title:"¿Está seguro(a) de anular la atención?",text:"¡Si no lo está, puede cancelar la acción!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#343a40",cancelButtonText:"Cancelar",cancelButtonColor:"#d33",confirmButtonText:"¡Sí, anular Atención!"}).then(function(n){n.value&&(window.location="index.php?ruta=atenciones&idAtencion="+e+"&idCuenta="+a+"&idEpisodio="+t+"&idUsuario="+o)})});